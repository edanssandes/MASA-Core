<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MASA-Core: AlignmentBinaryFile.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MASA-Core
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">AlignmentBinaryFile.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AlignmentBinaryFile_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*******************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright (c) 2010-2015   Edans Sandes</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * This file is part of MASA-Core.</span>
<a name="l00006"></a>00006 <span class="comment"> * </span>
<a name="l00007"></a>00007 <span class="comment"> * MASA-Core is free software: you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment"> * (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"> * </span>
<a name="l00012"></a>00012 <span class="comment"> * MASA-Core is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"> * </span>
<a name="l00017"></a>00017 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment"> * along with MASA-Core.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> ******************************************************************************/</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="AlignmentBinaryFile_8hpp.html">AlignmentBinaryFile.hpp</a>&quot;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00026"></a>00026 <span class="keyword">using namespace </span>std;
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;arpa/inet.h&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="Constants_8hpp.html">Constants.hpp</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;../../common/BlocksFile.hpp&quot;</span>
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a68854f4d68528882dcf1f279d7deeaab">00035</a> <span class="preprocessor">#define MAGIC_HEADER            &quot;CGFF&quot;</span>
<a name="l00036"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a7850310d2513f6050a4fea616ddab1fc">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define MAGIC_HEADER_LEN        4 //in bytes</span>
<a name="l00037"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#ada233e5218c8390ac9aabdfe5c4ace6c">00037</a> <span class="preprocessor"></span><span class="preprocessor">#define FILE_VERSION_MAJOR      0</span>
<a name="l00038"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a4154d27e45371f29e70856f8e964b3a8">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define FILE_VERSION_MINOR      1</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">00041</a> <span class="preprocessor">#define END_OF_FIELDS                                   (0)</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a8befbcf455c49ae6a508a2f3536f183a">00043</a> <span class="preprocessor">#define FIELD_ALIGNMENT_METHOD                  (1)</span>
<a name="l00044"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a0bfe95dc31a347237bc7e82b1d1324ac">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SCORING_SYSTEM                    (2)</span>
<a name="l00045"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a770850a97029abd4aa5bf2d86fcb540f">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_PENALTY_SYSTEM                    (3)</span>
<a name="l00046"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a9eee70421e11f9738d6bfae89704638f">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SEQUENCE_PARAMS                   (4)</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span>
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a5de8f875833fb7c8b91f8eb8670de163">00049</a> <span class="preprocessor">#define FIELD_SEQUENCE_DESCRIPTION              (1)</span>
<a name="l00050"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a58523b3734c96f81c8d714143434ff04">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SEQUENCE_TYPE                             (2)</span>
<a name="l00051"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#ad4413cec839bb0858afd512e8405b8c3">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SEQUENCE_SIZE                             (3)</span>
<a name="l00052"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a63cef720a0d4b016ce8cde5fc43b014e">00052</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SEQUENCE_HASH                             (4)</span>
<a name="l00053"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a478a3b1a9ebd67e61d8b13dd091767ef">00053</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SEQUENCE_DATA_PLAIN               (5)</span>
<a name="l00054"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#ad27781ca32cd1cbe121df2d901ac34e8">00054</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_SEQUENCE_DATA_COMPRESSED  (6)</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a089651d19ab00feacd8753b1f078ec73">00056</a> <span class="preprocessor">#define FIELD_RESULT_RAW_SCORE                  (1)</span>
<a name="l00057"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a6556075697c37d6c2a7b546551e77447">00057</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_RESULT_BIT_SCORE                  (2)</span>
<a name="l00058"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a740dc9dc419e73dd53bef0de8b1059d3">00058</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_RESULT_E_VALUE                    (3)</span>
<a name="l00059"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#aca59ed72bd5722c469e1ea6bc6aca114">00059</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_RESULT_SCORE_STATISTICS   (4)</span>
<a name="l00060"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#aff7a260057fc02dd549abf879238ed3c">00060</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_RESULT_GAP_LIST                   (5)</span>
<a name="l00061"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#acab6b675feded0b3fb43ac7df8dc948b">00061</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_RESULT_BLOCKS                             (6)</span>
<a name="l00062"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#a180e4235090ecd67588e1bb1d22888e7">00062</a> <span class="preprocessor"></span><span class="preprocessor">#define FIELD_RESULT_CELLS                              (7)</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="AlignmentBinaryFile_8cpp.html#aed70ae007dd6fbbcbe0c7808b063e503">00065</a> <span class="preprocessor">#define MAX_SEQUENCES   (2)</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="classAlignmentBinaryFile.html#a450503f812a5e4c49745078b01557c98">00068</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a450503f812a5e4c49745078b01557c98">AlignmentBinaryFile::write</a>(<span class="keywordtype">string</span> filename, <a class="code" href="classAlignment.html">Alignment</a>* alignment) {
<a name="l00069"></a>00069     FILE* file = fopen(filename.c_str(), <span class="stringliteral">&quot;wb&quot;</span>);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     fwrite_header(file);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073     <a class="code" href="classAlignmentParams.html">AlignmentParams</a>* params = alignment-&gt;<a class="code" href="classAlignment.html#ab9c1a10e320ebb5d0c6bd0ff6d1cef5e">getAlignmentParams</a>();
<a name="l00074"></a>00074     vector&lt;Sequence*&gt; sequences = params-&gt;<a class="code" href="classAlignmentParams.html#a8b410ec9506adae04ad1dd8b2121d692">getSequences</a>();
<a name="l00075"></a>00075     vector&lt;SequenceInfo*&gt; info;
<a name="l00076"></a>00076     info.clear();
<a name="l00077"></a>00077     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sequences.size(); i++) {
<a name="l00078"></a>00078         sequences[i]-&gt;getInfo()-&gt;setIndex(i);
<a name="l00079"></a>00079         info.push_back(sequences[i]-&gt;getInfo());
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081 
<a name="l00082"></a>00082 
<a name="l00083"></a>00083     fwrite_sequences(info, file);
<a name="l00084"></a>00084     fwrite_alignment_params(params, file);
<a name="l00085"></a>00085     fwrite_alignment_result(alignment, file);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     fclose(file);
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a><a class="code" href="classAlignmentBinaryFile.html#a7bcaef98935751c5a0b5d49f63b2f9b8">00090</a> <a class="code" href="classAlignment.html">Alignment</a>* <a class="code" href="classAlignmentBinaryFile.html#a7bcaef98935751c5a0b5d49f63b2f9b8">AlignmentBinaryFile::read</a>(<span class="keywordtype">string</span> filename) {
<a name="l00091"></a>00091         FILE* file = fopen(filename.c_str(), <span class="stringliteral">&quot;rb&quot;</span>);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         fread_header(file);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095         vector&lt;SequenceInfo*&gt; sequences = fread_sequences(file);
<a name="l00096"></a>00096         <a class="code" href="classAlignmentParams.html">AlignmentParams</a>* params = fread_alignment_params(sequences, file);
<a name="l00097"></a>00097         <a class="code" href="classAlignment.html">Alignment</a>* alignment = fread_alignment_result(params, file);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         fclose(file);
<a name="l00100"></a>00100         <span class="keywordflow">return</span> alignment;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classAlignmentBinaryFile.html#ac6e36689bcdef99312e53fb1b65b2e82">00103</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#ac6e36689bcdef99312e53fb1b65b2e82">AlignmentBinaryFile::fwrite_header</a>(FILE* file) {
<a name="l00104"></a>00104         fwrite_array(<a class="code" href="AlignmentBinaryFile_8cpp.html#a68854f4d68528882dcf1f279d7deeaab">MAGIC_HEADER</a>, <a class="code" href="AlignmentBinaryFile_8cpp.html#a7850310d2513f6050a4fea616ddab1fc">MAGIC_HEADER_LEN</a>, file);
<a name="l00105"></a>00105         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#ada233e5218c8390ac9aabdfe5c4ace6c">FILE_VERSION_MAJOR</a>, file);
<a name="l00106"></a>00106         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a4154d27e45371f29e70856f8e964b3a8">FILE_VERSION_MINOR</a>, file);
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="classAlignmentBinaryFile.html#a5525225c692c506c9a4bc7b9539daa84">00109</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a5525225c692c506c9a4bc7b9539daa84">AlignmentBinaryFile::fread_header</a>(FILE* file) {
<a name="l00110"></a>00110         <span class="keywordtype">char</span> header[<a class="code" href="AlignmentBinaryFile_8cpp.html#a7850310d2513f6050a4fea616ddab1fc">MAGIC_HEADER_LEN</a>];
<a name="l00111"></a>00111         fread_array(header, <a class="code" href="AlignmentBinaryFile_8cpp.html#a7850310d2513f6050a4fea616ddab1fc">MAGIC_HEADER_LEN</a>, file);
<a name="l00112"></a>00112         <span class="keywordflow">if</span> (memcmp(header, <a class="code" href="AlignmentBinaryFile_8cpp.html#a68854f4d68528882dcf1f279d7deeaab">MAGIC_HEADER</a>, <a class="code" href="AlignmentBinaryFile_8cpp.html#a7850310d2513f6050a4fea616ddab1fc">MAGIC_HEADER_LEN</a>) != 0) {
<a name="l00113"></a>00113                 fprintf(stderr, <span class="stringliteral">&quot;Wrong File Format. Header Error.\n&quot;</span>);
<a name="l00114"></a>00114                 <span class="comment">// TODO ERROR</span>
<a name="l00115"></a>00115                 <span class="keywordflow">return</span>;
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117         <span class="keywordtype">int</span> file_version_major = fread_int1(file);
<a name="l00118"></a>00118         <span class="keywordtype">int</span> file_version_minor = fread_int1(file);
<a name="l00119"></a>00119         <span class="keywordflow">if</span> (file_version_major &gt; <a class="code" href="AlignmentBinaryFile_8cpp.html#ada233e5218c8390ac9aabdfe5c4ace6c">FILE_VERSION_MAJOR</a>) {
<a name="l00120"></a>00120                 fprintf(stderr, <span class="stringliteral">&quot;File Version not supported (%d.%d &gt; %d.%d).\n&quot;</span>,
<a name="l00121"></a>00121                                 file_version_major, file_version_minor,
<a name="l00122"></a>00122                                 <a class="code" href="AlignmentBinaryFile_8cpp.html#ada233e5218c8390ac9aabdfe5c4ace6c">FILE_VERSION_MAJOR</a>, <a class="code" href="AlignmentBinaryFile_8cpp.html#a4154d27e45371f29e70856f8e964b3a8">FILE_VERSION_MINOR</a>);
<a name="l00123"></a>00123                 <span class="comment">// TODO ERROR</span>
<a name="l00124"></a>00124                 <span class="keywordflow">return</span>;
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="classAlignmentBinaryFile.html#a6806cae9012da9cab6fcfbce2ae32ff4">00128</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a6806cae9012da9cab6fcfbce2ae32ff4">AlignmentBinaryFile::fwrite_sequences</a>(vector&lt;SequenceInfo*&gt; sequences, FILE* file) {
<a name="l00129"></a>00129         <span class="keywordtype">int</span> count = sequences.size();
<a name="l00130"></a>00130         fwrite_int4(count, file);
<a name="l00131"></a>00131         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00132"></a>00132                 <a class="code" href="classSequenceInfo.html">SequenceInfo</a>* seq = sequences[i];
<a name="l00133"></a>00133                 seq-&gt;<a class="code" href="classSequenceInfo.html#a4b67c38c13b4f6a2613d56f1a17eed76">setIndex</a>(i);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135                 fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a5de8f875833fb7c8b91f8eb8670de163">FIELD_SEQUENCE_DESCRIPTION</a>, file);
<a name="l00136"></a>00136                 fwrite_str(seq-&gt;<a class="code" href="classSequenceInfo.html#af295b72f14fbc596987e9229f919c5d7">getDescription</a>().c_str(), file);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138                 fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a58523b3734c96f81c8d714143434ff04">FIELD_SEQUENCE_TYPE</a>, file);
<a name="l00139"></a>00139                 fwrite_int1(seq-&gt;<a class="code" href="classSequenceInfo.html#ab3bc74f4a8e1002ccf6a0fc411e4f820">getType</a>(), file);
<a name="l00140"></a>00140 
<a name="l00141"></a>00141                 fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#ad4413cec839bb0858afd512e8405b8c3">FIELD_SEQUENCE_SIZE</a>, file);
<a name="l00142"></a>00142                 fwrite_int4(seq-&gt;<a class="code" href="classSequenceInfo.html#adf3c978303cc1c1890524809dad65c28">getSize</a>(), file);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144                 fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">END_OF_FIELDS</a>, file);
<a name="l00145"></a>00145         }
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a><a class="code" href="classAlignmentBinaryFile.html#afdc3130e8b8035d67cd6a8bca2d866ca">00148</a> vector&lt;SequenceInfo*&gt; <a class="code" href="classAlignmentBinaryFile.html#afdc3130e8b8035d67cd6a8bca2d866ca">AlignmentBinaryFile::fread_sequences</a>(FILE* file) {
<a name="l00149"></a>00149         vector&lt;SequenceInfo*&gt; sequences;
<a name="l00150"></a>00150         <span class="keywordtype">int</span> count = fread_int4(file);
<a name="l00151"></a>00151         <span class="keywordflow">if</span> (count &gt; <a class="code" href="AlignmentBinaryFile_8cpp.html#aed70ae007dd6fbbcbe0c7808b063e503">MAX_SEQUENCES</a>) {
<a name="l00152"></a>00152                 fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: too many sequences (%d &gt; %d).\n&quot;</span>, count, <a class="code" href="AlignmentBinaryFile_8cpp.html#aed70ae007dd6fbbcbe0c7808b063e503">MAX_SEQUENCES</a>);
<a name="l00153"></a>00153                 exit(0);
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00156"></a>00156                 <a class="code" href="classSequenceInfo.html">SequenceInfo</a>* info = <span class="keyword">new</span> <a class="code" href="classSequenceInfo.html">SequenceInfo</a>();
<a name="l00157"></a>00157                 sequences.push_back(info);
<a name="l00158"></a>00158                 <span class="keywordtype">int</span> field;
<a name="l00159"></a>00159                 <span class="keywordflow">while</span> ((field = fread_int1(file)) != <a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">END_OF_FIELDS</a>) {
<a name="l00160"></a>00160 
<a name="l00161"></a>00161                         <span class="keywordtype">int</span> field_len;
<a name="l00162"></a>00162                         <span class="keywordtype">string</span> str = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00163"></a>00163                         <span class="keywordflow">switch</span> (field) {
<a name="l00164"></a>00164                                 <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a5de8f875833fb7c8b91f8eb8670de163">FIELD_SEQUENCE_DESCRIPTION</a>:
<a name="l00165"></a>00165                                         info-&gt;<a class="code" href="classSequenceInfo.html#aaf7da696db82a3b16e801b21173729d0">setDescription</a>(fread_str(file));
<a name="l00166"></a>00166                                         <span class="keywordflow">break</span>;
<a name="l00167"></a>00167                                 <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a58523b3734c96f81c8d714143434ff04">FIELD_SEQUENCE_TYPE</a>:
<a name="l00168"></a>00168                                         info-&gt;<a class="code" href="classSequenceInfo.html#a0237528f9b843af472634019a017423f">setType</a>(fread_int1(file));
<a name="l00169"></a>00169                                         <span class="keywordflow">break</span>;
<a name="l00170"></a>00170                                 <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#ad4413cec839bb0858afd512e8405b8c3">FIELD_SEQUENCE_SIZE</a>:
<a name="l00171"></a>00171                                         info-&gt;<a class="code" href="classSequenceInfo.html#a31f1c2b8700b48d19393a9699b924d36">setSize</a>(fread_int4(file));
<a name="l00172"></a>00172                                         <span class="keywordflow">break</span>;
<a name="l00173"></a>00173                                 <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a63cef720a0d4b016ce8cde5fc43b014e">FIELD_SEQUENCE_HASH</a>:
<a name="l00174"></a>00174                                         info-&gt;<a class="code" href="classSequenceInfo.html#ae32ce1dc1fe3bada1f4f0896c70838d0">setHash</a>(fread_str(file));
<a name="l00175"></a>00175                                         <span class="keywordflow">break</span>;
<a name="l00176"></a>00176                                 <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a478a3b1a9ebd67e61d8b13dd091767ef">FIELD_SEQUENCE_DATA_PLAIN</a>:
<a name="l00177"></a>00177                                         field_len = fread_int4(file);
<a name="l00178"></a>00178                                         fread_dummy(field_len, file);
<a name="l00179"></a>00179                                         <span class="keywordflow">break</span>;
<a name="l00180"></a>00180                                 <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#ad27781ca32cd1cbe121df2d901ac34e8">FIELD_SEQUENCE_DATA_COMPRESSED</a>:
<a name="l00181"></a>00181                                         field_len = fread_int4(file);
<a name="l00182"></a>00182                                         fread_dummy(field_len, file);
<a name="l00183"></a>00183                                         <span class="keywordflow">break</span>;
<a name="l00184"></a>00184                                 <span class="keywordflow">default</span>:
<a name="l00185"></a>00185                                         fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: Unknown Field (%d).\n&quot;</span>, field);
<a name="l00186"></a>00186                                         exit(0);
<a name="l00187"></a>00187                                         <span class="keywordflow">break</span>;
<a name="l00188"></a>00188 
<a name="l00189"></a>00189                         }
<a name="l00190"></a>00190                 }
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192         <span class="keywordflow">return</span> sequences;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="classAlignmentBinaryFile.html#ad238c321f9a9aab76921e8f655b8cb49">00196</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#ad238c321f9a9aab76921e8f655b8cb49">AlignmentBinaryFile::fwrite_alignment_params</a>(<a class="code" href="classAlignmentParams.html">AlignmentParams</a>* params, FILE* file) {
<a name="l00197"></a>00197         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a8befbcf455c49ae6a508a2f3536f183a">FIELD_ALIGNMENT_METHOD</a>, file);
<a name="l00198"></a>00198         fwrite_int1(params-&gt;<a class="code" href="classAlignmentParams.html#a6d030c9f065a41601c4e4b11fc03587f">getAlignmentMethod</a>(), file);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a0bfe95dc31a347237bc7e82b1d1324ac">FIELD_SCORING_SYSTEM</a>, file);
<a name="l00201"></a>00201         fwrite_int1(params-&gt;<a class="code" href="classAlignmentParams.html#a052eb6afb8c221a8db045490ccffcebf">getScoreSystem</a>(), file);
<a name="l00202"></a>00202         <span class="keywordflow">switch</span> (params-&gt;<a class="code" href="classAlignmentParams.html#a052eb6afb8c221a8db045490ccffcebf">getScoreSystem</a>()) {
<a name="l00203"></a>00203                 <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#aa7abc16a92c0ac897b51f7ef2462de62">SCORE_MATCH_MISMATCH</a>:
<a name="l00204"></a>00204                         fwrite_int4(params-&gt;<a class="code" href="classAlignmentParams.html#ae0385eb3ba1bd22735dd995be1d32d5d">getMatch</a>(), file);
<a name="l00205"></a>00205                         fwrite_int4(params-&gt;<a class="code" href="classAlignmentParams.html#afb461ef864e5a1dadef64d56aecc7b23">getMismatch</a>(), file);
<a name="l00206"></a>00206                         <span class="keywordflow">break</span>;
<a name="l00207"></a>00207                 <span class="keywordflow">default</span>:
<a name="l00208"></a>00208                         fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: Unknown Score System (%d).\n&quot;</span>, params-&gt;<a class="code" href="classAlignmentParams.html#a16247cd124f7cfc30ebafaaad65c8801">getPenaltySystem</a>());
<a name="l00209"></a>00209                         exit(0);
<a name="l00210"></a>00210                         <span class="keywordflow">break</span>;
<a name="l00211"></a>00211         }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a770850a97029abd4aa5bf2d86fcb540f">FIELD_PENALTY_SYSTEM</a>, file);
<a name="l00214"></a>00214         fwrite_int1(params-&gt;<a class="code" href="classAlignmentParams.html#a16247cd124f7cfc30ebafaaad65c8801">getPenaltySystem</a>(), file);
<a name="l00215"></a>00215         <span class="keywordflow">switch</span> (params-&gt;<a class="code" href="classAlignmentParams.html#a16247cd124f7cfc30ebafaaad65c8801">getPenaltySystem</a>()) {
<a name="l00216"></a>00216                 <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#aff665b568d21cde823c76073f85b9a4b">PENALTY_LINEAR_GAP</a>:
<a name="l00217"></a>00217                         fwrite_int4(params-&gt;<a class="code" href="classAlignmentParams.html#a851c52130638adf3f08e00a72056ed89">getGapExtension</a>(), file);
<a name="l00218"></a>00218                         <span class="keywordflow">break</span>;
<a name="l00219"></a>00219                 <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#a57df88772ad68f42bf8bf88db4052ac2">PENALTY_AFFINE_GAP</a>:
<a name="l00220"></a>00220                         fwrite_int4(params-&gt;<a class="code" href="classAlignmentParams.html#a41c1a3d5e4955851531ac40e147ce797">getGapOpen</a>(), file);
<a name="l00221"></a>00221                         fwrite_int4(params-&gt;<a class="code" href="classAlignmentParams.html#a851c52130638adf3f08e00a72056ed89">getGapExtension</a>(), file);
<a name="l00222"></a>00222                         <span class="keywordflow">break</span>;
<a name="l00223"></a>00223                 <span class="keywordflow">default</span>:
<a name="l00224"></a>00224                         fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: Unknown Penalty System (%d).\n&quot;</span>, params-&gt;<a class="code" href="classAlignmentParams.html#a16247cd124f7cfc30ebafaaad65c8801">getPenaltySystem</a>());
<a name="l00225"></a>00225                         exit(0);
<a name="l00226"></a>00226                         <span class="keywordflow">break</span>;
<a name="l00227"></a>00227         }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a9eee70421e11f9738d6bfae89704638f">FIELD_SEQUENCE_PARAMS</a>, file);
<a name="l00230"></a>00230         <span class="keywordtype">int</span> count = params-&gt;<a class="code" href="classAlignmentParams.html#a1f15e31e3f1050744883c0f97cc717f1">getSequencesCount</a>();
<a name="l00231"></a>00231         fwrite_int4(count, file);
<a name="l00232"></a>00232         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00233"></a>00233                 <a class="code" href="classSequenceInfo.html">SequenceInfo</a>* sequenceInfo = params-&gt;<a class="code" href="classAlignmentParams.html#ab3061626d2a79ef448d51e996a2c28a2">getSequence</a>(i)-&gt;<a class="code" href="classSequence.html#aedf347b3307d520fdb1cec5007ff4e36">getInfo</a>();
<a name="l00234"></a>00234                 fwrite_int4(sequenceInfo-&gt;<a class="code" href="classSequenceInfo.html#a394613e4366ce90869e306e09025d13e">getIndex</a>(), file);
<a name="l00235"></a>00235                 <a class="code" href="classSequenceModifiers.html">SequenceModifiers</a>* modifiers = params-&gt;<a class="code" href="classAlignmentParams.html#ab3061626d2a79ef448d51e996a2c28a2">getSequence</a>(i)-&gt;<a class="code" href="classSequence.html#a55663f13ab7a291493d5ea68ccfaf567">getModifiers</a>();
<a name="l00236"></a>00236                 fwrite_flags(modifiers, file);
<a name="l00237"></a>00237         }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">END_OF_FIELDS</a>, file);
<a name="l00240"></a>00240 }
<a name="l00241"></a>00241 
<a name="l00242"></a><a class="code" href="classAlignmentBinaryFile.html#abb5e30ee059b9414d8913a7202abd928">00242</a> <a class="code" href="classAlignmentParams.html">AlignmentParams</a>* <a class="code" href="classAlignmentBinaryFile.html#abb5e30ee059b9414d8913a7202abd928">AlignmentBinaryFile::fread_alignment_params</a>(vector&lt;SequenceInfo*&gt; sequences, FILE* file) {
<a name="l00243"></a>00243         <a class="code" href="classAlignmentParams.html">AlignmentParams</a>* params = <span class="keyword">new</span> <a class="code" href="classAlignmentParams.html">AlignmentParams</a>();
<a name="l00244"></a>00244         <span class="keywordtype">int</span> field;
<a name="l00245"></a>00245         <span class="keywordflow">while</span> ((field = fread_int1(file)) != <a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">END_OF_FIELDS</a>) {
<a name="l00246"></a>00246                 <span class="keywordflow">switch</span> (field) {
<a name="l00247"></a>00247                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a8befbcf455c49ae6a508a2f3536f183a">FIELD_ALIGNMENT_METHOD</a>:
<a name="l00248"></a>00248                                 params-&gt;<a class="code" href="classAlignmentParams.html#a0732bce2afbd54a8ad62da866db6fab6">setAlignmentMethod</a>(fread_int1(file));
<a name="l00249"></a>00249                                 <span class="keywordflow">break</span>;
<a name="l00250"></a>00250                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a0bfe95dc31a347237bc7e82b1d1324ac">FIELD_SCORING_SYSTEM</a>:
<a name="l00251"></a>00251                                 params-&gt;<a class="code" href="classAlignmentParams.html#ae7d575d926714bd5daf42b510094e01a">setScoreSystem</a>(fread_int1(file));
<a name="l00252"></a>00252                                 <span class="keywordflow">switch</span> (params-&gt;<a class="code" href="classAlignmentParams.html#a052eb6afb8c221a8db045490ccffcebf">getScoreSystem</a>()) {
<a name="l00253"></a>00253                                         <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#aa7abc16a92c0ac897b51f7ef2462de62">SCORE_MATCH_MISMATCH</a>: {
<a name="l00254"></a>00254                                                 <span class="keywordtype">int</span> match = fread_int4(file);
<a name="l00255"></a>00255                                                 <span class="keywordtype">int</span> mismatch = fread_int4(file);
<a name="l00256"></a>00256                                                 params-&gt;<a class="code" href="classAlignmentParams.html#a790833319364707a6025303fdc699a0a">setMatchMismatchScores</a>(match, mismatch);
<a name="l00257"></a>00257                                                 <span class="keywordflow">break</span>;
<a name="l00258"></a>00258                                         }
<a name="l00259"></a>00259                                         <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#a5fdd8ac2e0aee6ef6ce1ce90caa0a7b9">SCORE_SIMILARITY_MATRIX</a>: {
<a name="l00260"></a>00260                                                 fprintf(stderr, <span class="stringliteral">&quot;Score Matrix not supported yet.\n&quot;</span>);
<a name="l00261"></a>00261                                                 exit(0);
<a name="l00262"></a>00262                                                 <span class="keywordflow">break</span>;
<a name="l00263"></a>00263                                         }
<a name="l00264"></a>00264                                         <span class="keywordflow">default</span>:
<a name="l00265"></a>00265                                                 fprintf(stderr, <span class="stringliteral">&quot;Unknown Score System.\n&quot;</span>);
<a name="l00266"></a>00266                                                 exit(1);
<a name="l00267"></a>00267                                                 <span class="keywordflow">break</span>;
<a name="l00268"></a>00268                                 }
<a name="l00269"></a>00269                                 <span class="keywordflow">break</span>;
<a name="l00270"></a>00270                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a770850a97029abd4aa5bf2d86fcb540f">FIELD_PENALTY_SYSTEM</a>:
<a name="l00271"></a>00271                                 params-&gt;<a class="code" href="classAlignmentParams.html#af62bac50d389debf23556428aafcdf24">setPenaltySystem</a>(fread_int1(file));
<a name="l00272"></a>00272                                 <span class="keywordflow">switch</span> (params-&gt;<a class="code" href="classAlignmentParams.html#a16247cd124f7cfc30ebafaaad65c8801">getPenaltySystem</a>()) {
<a name="l00273"></a>00273                                         <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#aff665b568d21cde823c76073f85b9a4b">PENALTY_LINEAR_GAP</a>: {
<a name="l00274"></a>00274                                                 <span class="keywordtype">int</span> gapOpen = 0;
<a name="l00275"></a>00275                                                 <span class="keywordtype">int</span> gapExtension = fread_int4(file);
<a name="l00276"></a>00276                                                 params-&gt;<a class="code" href="classAlignmentParams.html#a3fd51701f0c19b8d68126059e3a2d3c7">setAffineGapPenalties</a>(gapOpen, gapExtension);
<a name="l00277"></a>00277                                                 <span class="keywordflow">break</span>;
<a name="l00278"></a>00278                                         }
<a name="l00279"></a>00279                                         <span class="keywordflow">case</span> <a class="code" href="Constants_8hpp.html#a57df88772ad68f42bf8bf88db4052ac2">PENALTY_AFFINE_GAP</a>: {
<a name="l00280"></a>00280                                                 <span class="keywordtype">int</span> gapOpen = fread_int4(file);
<a name="l00281"></a>00281                                                 <span class="keywordtype">int</span> gapExtension = fread_int4(file);
<a name="l00282"></a>00282                                                 params-&gt;<a class="code" href="classAlignmentParams.html#a3fd51701f0c19b8d68126059e3a2d3c7">setAffineGapPenalties</a>(gapOpen, gapExtension);
<a name="l00283"></a>00283                                                 <span class="keywordflow">break</span>;
<a name="l00284"></a>00284                                         }
<a name="l00285"></a>00285                                         <span class="keywordflow">default</span>:
<a name="l00286"></a>00286                                                 fprintf(stderr, <span class="stringliteral">&quot;Unknown Penalty System.\n&quot;</span>);
<a name="l00287"></a>00287                                                 exit(1);
<a name="l00288"></a>00288                                                 <span class="keywordflow">break</span>;
<a name="l00289"></a>00289                                 }
<a name="l00290"></a>00290                                 <span class="keywordflow">break</span>;
<a name="l00291"></a>00291                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a9eee70421e11f9738d6bfae89704638f">FIELD_SEQUENCE_PARAMS</a>: {
<a name="l00292"></a>00292                                 <span class="keywordtype">int</span> count = fread_int4(file);
<a name="l00293"></a>00293                                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00294"></a>00294                                         <span class="keywordtype">int</span> index = fread_int4(file);
<a name="l00295"></a>00295 
<a name="l00296"></a>00296                                         <a class="code" href="classSequenceModifiers.html">SequenceModifiers</a>* modifiers = fread_flags(file);
<a name="l00297"></a>00297 
<a name="l00298"></a>00298                                         params-&gt;<a class="code" href="classAlignmentParams.html#a4693732876a6fc5dd5801f0cc8f28047">addSequence</a>(<span class="keyword">new</span> <a class="code" href="classSequence.html">Sequence</a>(sequences[index], modifiers));
<a name="l00299"></a>00299                                 }
<a name="l00300"></a>00300                                 <span class="keywordflow">break</span>;
<a name="l00301"></a>00301                         }
<a name="l00302"></a>00302                         <span class="keywordflow">default</span>:
<a name="l00303"></a>00303                                 fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: Unknown Field (%d).\n&quot;</span>, field);
<a name="l00304"></a>00304                                 exit(0);
<a name="l00305"></a>00305                                 <span class="keywordflow">break</span>;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307                 }
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309         <span class="keywordflow">return</span> params;
<a name="l00310"></a>00310 }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00313"></a><a class="code" href="classAlignmentBinaryFile.html#a05d4e377c752894bbab9a5c95cd8312c">00313</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a05d4e377c752894bbab9a5c95cd8312c">AlignmentBinaryFile::fwrite_alignment_result</a>(<a class="code" href="classAlignment.html">Alignment</a>* alignment, FILE* file) {
<a name="l00314"></a>00314         fwrite_int4(1, file); <span class="comment">// Only 1 result is supported by now</span>
<a name="l00315"></a>00315         <span class="keywordtype">int</span> count = alignment-&gt;<a class="code" href="classAlignment.html#ab9c1a10e320ebb5d0c6bd0ff6d1cef5e">getAlignmentParams</a>()-&gt;<a class="code" href="classAlignmentParams.html#a1f15e31e3f1050744883c0f97cc717f1">getSequencesCount</a>();
<a name="l00316"></a>00316 
<a name="l00317"></a>00317         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a089651d19ab00feacd8753b1f078ec73">FIELD_RESULT_RAW_SCORE</a>, file);
<a name="l00318"></a>00318         fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#a5af582533856baa08a65b7594cbebeef">getRawScore</a>(), file);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#aca59ed72bd5722c469e1ea6bc6aca114">FIELD_RESULT_SCORE_STATISTICS</a>, file);
<a name="l00321"></a>00321         fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#a0a82c3e5e01c9bfcfb866a2500c4ba9c">getMatches</a>(), file);
<a name="l00322"></a>00322         fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#ac28bac8aa848b5dcad16ea558b2f06e6">getMismatches</a>(), file);
<a name="l00323"></a>00323         fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#ac3fba768f357492a99f816ee673b17d6">getGapOpen</a>(), file);
<a name="l00324"></a>00324         fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#ab1d2185a9093b5a152fd5a6c88591b93">getGapExtensions</a>(), file);
<a name="l00325"></a>00325 
<a name="l00326"></a>00326         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#aff7a260057fc02dd549abf879238ed3c">FIELD_RESULT_GAP_LIST</a>, file);
<a name="l00327"></a>00327         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00328"></a>00328                 fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#ad55dc1bb8616c7add21a5b5579147f48">getStart</a>(i), file);
<a name="l00329"></a>00329                 fwrite_int4(alignment-&gt;<a class="code" href="classAlignment.html#a2cfffd05265a3381303e08d5d751ce9a">getEnd</a>(i), file);
<a name="l00330"></a>00330                 fwrite_gaps(alignment-&gt;<a class="code" href="classAlignment.html#acc97367818dfdf56d99d0650f66bf7f4">getGaps</a>(i), file);
<a name="l00331"></a>00331         }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="keywordflow">if</span> (!alignment-&gt;<a class="code" href="classAlignment.html#a2af09ab2f83476d9ee8992806203286b">getPruningFile</a>().empty()) {
<a name="l00334"></a>00334                 <span class="comment">//FILE* pruningFile = fopen(alignment-&gt;getPruningFile().c_str(), &quot;rb&quot;);</span>
<a name="l00335"></a>00335                 fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#acab6b675feded0b3fb43ac7df8dc948b">FIELD_RESULT_BLOCKS</a>, file);
<a name="l00336"></a>00336                 <a class="code" href="classBlocksFile.html">BlocksFile</a>* blocksFile = <span class="keyword">new</span> <a class="code" href="classBlocksFile.html">BlocksFile</a>(alignment-&gt;<a class="code" href="classAlignment.html#a2af09ab2f83476d9ee8992806203286b">getPruningFile</a>());
<a name="l00337"></a>00337                 <span class="keywordtype">int</span> bw = 512;
<a name="l00338"></a>00338                 <span class="keywordtype">int</span> bh = 512;
<a name="l00339"></a>00339                 <span class="keywordtype">int</span>* buffer = blocksFile-&gt;<a class="code" href="classBlocksFile.html#ad005b9680d2dc7f8c57223fc0a692f39">reduceData</a>(bh, bw);
<a name="l00340"></a>00340                 fwrite_int4(bh, file);
<a name="l00341"></a>00341                 fwrite_int4(bw, file);
<a name="l00342"></a>00342                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;bh*bw; i++) {
<a name="l00343"></a>00343                         fwrite_int4(buffer[i], file);
<a name="l00344"></a>00344                 }
<a name="l00345"></a>00345                 <span class="keyword">delete</span> blocksFile;
<a name="l00346"></a>00346 <span class="comment">//              int i;</span>
<a name="l00347"></a>00347 <span class="comment">//              while (fread(&amp;i, sizeof(int), 1, pruningFile) &gt; 0) {</span>
<a name="l00348"></a>00348 <span class="comment">//                      fwrite_int4(i, file);</span>
<a name="l00349"></a>00349 <span class="comment">//              }</span>
<a name="l00350"></a>00350 <span class="comment">//              fclose(pruningFile);</span>
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353         fwrite_int1(<a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">END_OF_FIELDS</a>, file);
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00356"></a><a class="code" href="classAlignmentBinaryFile.html#aa4fdcf3ac9c38c37e33fbdd1a16351f4">00356</a> <a class="code" href="classAlignment.html">Alignment</a>* <a class="code" href="classAlignmentBinaryFile.html#aa4fdcf3ac9c38c37e33fbdd1a16351f4">AlignmentBinaryFile::fread_alignment_result</a>(<a class="code" href="classAlignmentParams.html">AlignmentParams</a>* params, FILE* file) {
<a name="l00357"></a>00357         <span class="keywordtype">int</span> results = fread_int4(file);
<a name="l00358"></a>00358         <span class="keywordflow">if</span> (results &gt; 1) {
<a name="l00359"></a>00359                 <span class="comment">// Only 1 result is supported by now</span>
<a name="l00360"></a>00360                 fprintf(stderr, <span class="stringliteral">&quot;Too many results %d.\n&quot;</span>, results);
<a name="l00361"></a>00361                 exit(1);
<a name="l00362"></a>00362         }
<a name="l00363"></a>00363 
<a name="l00364"></a>00364         <a class="code" href="classAlignment.html">Alignment</a>* alignment = <span class="keyword">new</span> <a class="code" href="classAlignment.html">Alignment</a>(params);
<a name="l00365"></a>00365         <span class="keywordtype">int</span> count = params-&gt;<a class="code" href="classAlignmentParams.html#a1f15e31e3f1050744883c0f97cc717f1">getSequencesCount</a>();
<a name="l00366"></a>00366         <span class="keywordtype">int</span> field;
<a name="l00367"></a>00367         <span class="keywordflow">while</span> ((field = fread_int1(file)) != <a class="code" href="AlignmentBinaryFile_8cpp.html#a62a64d0706a32213f83ecd000d67d634">END_OF_FIELDS</a>) {
<a name="l00368"></a>00368                 <span class="keywordflow">switch</span> (field) {
<a name="l00369"></a>00369                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#a089651d19ab00feacd8753b1f078ec73">FIELD_RESULT_RAW_SCORE</a>:
<a name="l00370"></a>00370                                 alignment-&gt;<a class="code" href="classAlignment.html#a9fdb82f83993ee37b448532db447d8b0">setRawScore</a>(fread_int4(file));
<a name="l00371"></a>00371                                 <span class="keywordflow">break</span>;
<a name="l00372"></a>00372                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#aca59ed72bd5722c469e1ea6bc6aca114">FIELD_RESULT_SCORE_STATISTICS</a>:
<a name="l00373"></a>00373                                 alignment-&gt;<a class="code" href="classAlignment.html#a3c82840ebc951bcf0a605ab1c5099ea4">setMatches</a>(fread_int4(file));
<a name="l00374"></a>00374                                 alignment-&gt;<a class="code" href="classAlignment.html#a29907311e83744d1fe0ba661b9d34ed8">setMismatches</a>(fread_int4(file));
<a name="l00375"></a>00375                                 alignment-&gt;<a class="code" href="classAlignment.html#a43fe2aaeea68b9c3641cb8401f228014">setGapOpen</a>(fread_int4(file));
<a name="l00376"></a>00376                                 alignment-&gt;<a class="code" href="classAlignment.html#a2d0a6a8ce5023f5969a79d0010624c6b">setGapExtensions</a>(fread_int4(file));
<a name="l00377"></a>00377                                 <span class="keywordflow">break</span>;
<a name="l00378"></a>00378                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#aff7a260057fc02dd549abf879238ed3c">FIELD_RESULT_GAP_LIST</a>:{
<a name="l00379"></a>00379                                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00380"></a>00380                                         alignment-&gt;<a class="code" href="classAlignment.html#a02533f96c773b6b398a88b9c6905027a">setStart</a>(i, fread_int4(file));
<a name="l00381"></a>00381                                         alignment-&gt;<a class="code" href="classAlignment.html#a402e94d1a3813c09532d97ad233ec926">setEnd</a>(i, fread_int4(file));
<a name="l00382"></a>00382                                         fread_gaps(alignment-&gt;<a class="code" href="classAlignment.html#acc97367818dfdf56d99d0650f66bf7f4">getGaps</a>(i), file);
<a name="l00383"></a>00383                                 }
<a name="l00384"></a>00384                                 <span class="keywordflow">break</span>;
<a name="l00385"></a>00385                         }
<a name="l00386"></a>00386                         <span class="keywordflow">case</span> <a class="code" href="AlignmentBinaryFile_8cpp.html#acab6b675feded0b3fb43ac7df8dc948b">FIELD_RESULT_BLOCKS</a>:{
<a name="l00387"></a>00387                                 <span class="keywordtype">int</span> h = fread_int4(file);
<a name="l00388"></a>00388                                 <span class="keywordtype">int</span> w = fread_int4(file);
<a name="l00389"></a>00389                                 <span class="comment">// NOT IMPLEMENTED FOR READING</span>
<a name="l00390"></a>00390                                 fread_dummy(h*w*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), file);
<a name="l00391"></a>00391                                 <span class="keywordflow">break</span>;
<a name="l00392"></a>00392                         }
<a name="l00393"></a>00393                         <span class="keywordflow">default</span>:
<a name="l00394"></a>00394                                 fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: Unknown Field (%d).\n&quot;</span>, field);
<a name="l00395"></a>00395                                 exit(0);
<a name="l00396"></a>00396                                 <span class="keywordflow">break</span>;
<a name="l00397"></a>00397 
<a name="l00398"></a>00398                 }
<a name="l00399"></a>00399         }
<a name="l00400"></a>00400         <span class="keywordflow">return</span> alignment;
<a name="l00401"></a>00401 }
<a name="l00402"></a>00402 
<a name="l00403"></a><a class="code" href="classAlignmentBinaryFile.html#acd70fc0980e0b3359b75b9a10b722192">00403</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#acd70fc0980e0b3359b75b9a10b722192">AlignmentBinaryFile::fwrite_flags</a>(<a class="code" href="classSequenceModifiers.html">SequenceModifiers</a>* modifiers, FILE* file) {
<a name="l00404"></a>00404         <span class="keywordtype">int</span> flags = 0;
<a name="l00405"></a>00405         <span class="keywordflow">if</span> (modifiers-&gt;<a class="code" href="classSequenceModifiers.html#ad5c1e983bc3ccbc11bcc521bf674455e">isClearN</a>()) {
<a name="l00406"></a>00406                 flags |= <a class="code" href="Constants_8hpp.html#a66c823c1af2dae8259b04eadb1b9f07e">FLAG_CLEAR_N</a>;
<a name="l00407"></a>00407         }
<a name="l00408"></a>00408         <span class="keywordflow">if</span> (modifiers-&gt;<a class="code" href="classSequenceModifiers.html#acfaa1721779649890128144af7ff0ef8">isComplement</a>()) {
<a name="l00409"></a>00409                 flags |= <a class="code" href="Constants_8hpp.html#aef8d557b53816b915efa31afd8bc3980">FLAG_COMPLEMENT</a>;
<a name="l00410"></a>00410         }
<a name="l00411"></a>00411         <span class="keywordflow">if</span> (modifiers-&gt;<a class="code" href="classSequenceModifiers.html#a9abae88ecdca1be6634256d89a8aa094">isReverse</a>()) {
<a name="l00412"></a>00412                 flags |= <a class="code" href="Constants_8hpp.html#aac4bbd7c716501fe50832491bd2d5ea0">FLAG_REVERSE</a>;
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414         fwrite_int4(flags, file);
<a name="l00415"></a>00415         fwrite_int4(modifiers-&gt;<a class="code" href="classSequenceModifiers.html#a5e15591da6fd39d486f99db4fa690146">getTrimStart</a>(), file);
<a name="l00416"></a>00416         fwrite_int4(modifiers-&gt;<a class="code" href="classSequenceModifiers.html#ab6f7e1d4f91a7ccfef88b07703bbe4fd">getTrimEnd</a>(), file);
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 
<a name="l00419"></a><a class="code" href="classAlignmentBinaryFile.html#a9fd6978d494424440efcd34a27f78b90">00419</a> <a class="code" href="classSequenceModifiers.html">SequenceModifiers</a>* <a class="code" href="classAlignmentBinaryFile.html#a9fd6978d494424440efcd34a27f78b90">AlignmentBinaryFile::fread_flags</a>(FILE* file) {
<a name="l00420"></a>00420         <a class="code" href="classSequenceModifiers.html">SequenceModifiers</a>* modifiers = <span class="keyword">new</span> <a class="code" href="classSequenceModifiers.html">SequenceModifiers</a>();
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         <span class="keywordtype">int</span> flags = fread_int4(file);
<a name="l00423"></a>00423         modifiers-&gt;<a class="code" href="classSequenceModifiers.html#acaadeafceaf8ebc123699e97063b41aa">setClearN</a>    ((flags &amp; <a class="code" href="Constants_8hpp.html#a66c823c1af2dae8259b04eadb1b9f07e">FLAG_CLEAR_N</a>) != 0);
<a name="l00424"></a>00424         modifiers-&gt;<a class="code" href="classSequenceModifiers.html#a3b3dc6baefdae3340023723fca949fff">setComplement</a>((flags &amp; <a class="code" href="Constants_8hpp.html#aef8d557b53816b915efa31afd8bc3980">FLAG_COMPLEMENT</a>) != 0);
<a name="l00425"></a>00425         modifiers-&gt;<a class="code" href="classSequenceModifiers.html#a9aad531e4e49ad047369946046d41ea9">setReverse</a>   ((flags &amp; <a class="code" href="Constants_8hpp.html#aac4bbd7c716501fe50832491bd2d5ea0">FLAG_REVERSE</a>) != 0);
<a name="l00426"></a>00426 
<a name="l00427"></a>00427         modifiers-&gt;<a class="code" href="classSequenceModifiers.html#ae9a8e59faca4afa218b64a63e53977b1">setTrimStart</a>(fread_int4(file));
<a name="l00428"></a>00428         modifiers-&gt;<a class="code" href="classSequenceModifiers.html#aaf5fd8e2b234e923a61ba57fee8190da">setTrimEnd</a>(fread_int4(file));
<a name="l00429"></a>00429 
<a name="l00430"></a>00430         <span class="keywordflow">return</span> modifiers;
<a name="l00431"></a>00431 }
<a name="l00432"></a>00432 
<a name="l00433"></a><a class="code" href="classAlignmentBinaryFile.html#acac73e5118a6b46e0b83dff8687c8d5e">00433</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#acac73e5118a6b46e0b83dff8687c8d5e">AlignmentBinaryFile::fwrite_gaps</a>(vector&lt;gap_t&gt;* gaps, FILE* file) {
<a name="l00434"></a>00434     <span class="keywordtype">int</span> count = gaps-&gt;size();
<a name="l00435"></a>00435         fwrite_int4(count, file);
<a name="l00436"></a>00436         <span class="comment">//printf(&quot;Gaps[%d]\n&quot;, count);</span>
<a name="l00437"></a>00437         <span class="keywordtype">int</span> last = 0;
<a name="l00438"></a>00438         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00439"></a>00439                 <span class="keywordtype">int</span> diff = (*gaps)[i].pos - last;
<a name="l00440"></a>00440                 last = (*gaps)[i].pos;
<a name="l00441"></a>00441                 <span class="comment">//fwrite_int4((*gaps)[i].pos, file);</span>
<a name="l00442"></a>00442                 <span class="comment">//fwrite_int4((*gaps)[i].len, file);</span>
<a name="l00443"></a>00443 
<a name="l00444"></a>00444                 fwrite_uint4_compressed(diff, file);
<a name="l00445"></a>00445                 fwrite_uint4_compressed((*gaps)[i].len, file);
<a name="l00446"></a>00446 
<a name="l00447"></a>00447                 <span class="comment">//printf(&quot;%4d: %8d %d\n&quot;, i, (*gaps)[i].pos, (*gaps)[i].len);</span>
<a name="l00448"></a>00448                 <span class="comment">//printf(&quot;%4d: +%8d %d\n&quot;, i, diff, (*gaps)[i].len);</span>
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 
<a name="l00453"></a>00453 
<a name="l00454"></a><a class="code" href="classAlignmentBinaryFile.html#a064efff3481affd66d55cc9bc1eb4155">00454</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a064efff3481affd66d55cc9bc1eb4155">AlignmentBinaryFile::fread_gaps</a>(vector&lt;gap_t&gt;* gaps, FILE* file) {
<a name="l00455"></a>00455         <span class="keywordtype">int</span> count = fread_int4(file);
<a name="l00456"></a>00456         gaps-&gt;clear();
<a name="l00457"></a>00457         <span class="comment">//printf(&quot;Gaps[%d]\n&quot;, count);</span>
<a name="l00458"></a>00458         <span class="keywordtype">int</span> last = 0;
<a name="l00459"></a>00459         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;count; i++) {
<a name="l00460"></a>00460                 <a class="code" href="structgap__t.html">gap_t</a> gap;
<a name="l00461"></a>00461                 <span class="comment">//gap.pos = fread_int4(file);</span>
<a name="l00462"></a>00462                 <span class="comment">//gap.len = fread_int4(file);</span>
<a name="l00463"></a>00463 
<a name="l00464"></a>00464                 gap.<a class="code" href="structgap__t.html#a529ec947615e908167b41868306211ef">pos</a> = last + fread_uint4_compressed(file);
<a name="l00465"></a>00465                 last = gap.<a class="code" href="structgap__t.html#a529ec947615e908167b41868306211ef">pos</a>;
<a name="l00466"></a>00466                 gap.<a class="code" href="structgap__t.html#a45f5e5739907ab450e89d1371e405043">len</a> = fread_uint4_compressed(file);
<a name="l00467"></a>00467                 gaps-&gt;push_back(gap);
<a name="l00468"></a>00468                 <span class="comment">//printf(&quot;%4d: %8d %d\n&quot;, i, gap.pos, gap.len);</span>
<a name="l00469"></a>00469         }
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="classAlignmentBinaryFile.html#a9a4872c4c2fa20d736340da9df940bf3">00473</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a9a4872c4c2fa20d736340da9df940bf3">AlignmentBinaryFile::fwrite_str</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* str, FILE* file) {
<a name="l00474"></a>00474     <span class="keywordtype">int</span> len = strlen(str);
<a name="l00475"></a>00475     fwrite_int4(len, file);
<a name="l00476"></a>00476     fwrite(str, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), len, file);
<a name="l00477"></a>00477 }
<a name="l00478"></a>00478 
<a name="l00479"></a><a class="code" href="classAlignmentBinaryFile.html#a844d998d671914749648c9bae33f7c74">00479</a> <span class="keywordtype">string</span> <a class="code" href="classAlignmentBinaryFile.html#a844d998d671914749648c9bae33f7c74">AlignmentBinaryFile::fread_str</a>(FILE* file) {
<a name="l00480"></a>00480     <span class="keywordtype">int</span> len = fread_int4(file);
<a name="l00481"></a>00481         <span class="keyword">const</span> <span class="keywordtype">int</span> max_len = 1000;
<a name="l00482"></a>00482         <span class="keywordflow">if</span> (len &gt; max_len) {
<a name="l00483"></a>00483                 fprintf(stderr, <span class="stringliteral">&quot;Sanity Check: string too large during file read (%d &gt; %d).\n&quot;</span>, len, max_len);
<a name="l00484"></a>00484                 exit(0);
<a name="l00485"></a>00485         }
<a name="l00486"></a>00486         <span class="keywordtype">char</span> cstr[max_len+5];
<a name="l00487"></a>00487     fread(cstr, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), len, file);
<a name="l00488"></a>00488     cstr[len] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00489"></a>00489         <span class="keywordflow">return</span> string(cstr);
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 
<a name="l00500"></a><a class="code" href="classAlignmentBinaryFile.html#a8ac54c319b2575b7d51c115416d7df77">00500</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a8ac54c319b2575b7d51c115416d7df77">AlignmentBinaryFile::fwrite_array</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* array, <span class="keyword">const</span> <span class="keywordtype">int</span> len, FILE* file) {
<a name="l00501"></a>00501     fwrite(array, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), len, file);
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="classAlignmentBinaryFile.html#a608c60be9535c49446e70713fb33a8c5">00504</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a608c60be9535c49446e70713fb33a8c5">AlignmentBinaryFile::fread_array</a>(<span class="keywordtype">char</span>* array, <span class="keyword">const</span> <span class="keywordtype">int</span> len, FILE* file) {
<a name="l00505"></a>00505     fread(array, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>), len, file);
<a name="l00506"></a>00506 }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 
<a name="l00509"></a><a class="code" href="classAlignmentBinaryFile.html#ae90475570705166724899a3a7aa7e2df">00509</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#ae90475570705166724899a3a7aa7e2df">AlignmentBinaryFile::fwrite_uint4_compressed</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, FILE* file) {
<a name="l00510"></a>00510         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b0 = (i &amp; 0xF0000000)&gt;&gt;28;
<a name="l00511"></a>00511         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b1 = (i &amp; 0x0FE00000)&gt;&gt;21;
<a name="l00512"></a>00512         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b2 = (i &amp; 0x001FC000)&gt;&gt;14;
<a name="l00513"></a>00513         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b3 = (i &amp; 0x00003F80)&gt;&gt;7;
<a name="l00514"></a>00514         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> b4 = (i &amp; 0x0000007F);
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <span class="keywordflow">if</span> (b0 &gt; 0) {
<a name="l00517"></a>00517                 fwrite_int1(0x80|b0, file);
<a name="l00518"></a>00518                 fwrite_int1(0x80|b1, file);
<a name="l00519"></a>00519                 fwrite_int1(0x80|b2, file);
<a name="l00520"></a>00520                 fwrite_int1(0x80|b3, file);
<a name="l00521"></a>00521                 fwrite_int1(b4, file);
<a name="l00522"></a>00522         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b1 &gt; 0) {
<a name="l00523"></a>00523                 fwrite_int1(0x80|b1, file);
<a name="l00524"></a>00524                 fwrite_int1(0x80|b2, file);
<a name="l00525"></a>00525                 fwrite_int1(0x80|b3, file);
<a name="l00526"></a>00526                 fwrite_int1(b4, file);
<a name="l00527"></a>00527         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b2 &gt; 0) {
<a name="l00528"></a>00528                 fwrite_int1(0x80|b2, file);
<a name="l00529"></a>00529                 fwrite_int1(0x80|b3, file);
<a name="l00530"></a>00530                 fwrite_int1(b4, file);
<a name="l00531"></a>00531         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b3 &gt; 0) {
<a name="l00532"></a>00532                 fwrite_int1(0x80|b3, file);
<a name="l00533"></a>00533                 fwrite_int1(b4, file);
<a name="l00534"></a>00534         } <span class="keywordflow">else</span> {
<a name="l00535"></a>00535                 fwrite_int1(b4, file);
<a name="l00536"></a>00536         }
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 
<a name="l00540"></a><a class="code" href="classAlignmentBinaryFile.html#a30ac1475c381a2faa3348657ba448cc5">00540</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classAlignmentBinaryFile.html#a30ac1475c381a2faa3348657ba448cc5">AlignmentBinaryFile::fread_uint4_compressed</a>(FILE* file) {
<a name="l00541"></a>00541         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> b = fread_int1(file);
<a name="l00542"></a>00542         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = (b &amp; 0x7F);
<a name="l00543"></a>00543         <span class="keywordflow">while</span> (b &gt;= 128) {
<a name="l00544"></a>00544                 b = fread_int1(file);
<a name="l00545"></a>00545                 i &lt;&lt;= 7;
<a name="l00546"></a>00546                 i |= (b &amp; 0x7F);
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548         <span class="keywordflow">return</span> i;
<a name="l00549"></a>00549 }
<a name="l00550"></a>00550 
<a name="l00551"></a><a class="code" href="classAlignmentBinaryFile.html#add3c902cd5ce56686a58b8037c737e8e">00551</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#add3c902cd5ce56686a58b8037c737e8e">AlignmentBinaryFile::fwrite_int4</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i, FILE* file) {
<a name="l00552"></a>00552         <span class="keyword">const</span> <span class="keywordtype">int</span> j = htonl(i);
<a name="l00553"></a>00553     fwrite(&amp;j, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), 1, file);
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 
<a name="l00556"></a><a class="code" href="classAlignmentBinaryFile.html#a881d870113fa00a47af25b1e572f4417">00556</a> <span class="keywordtype">int</span> <a class="code" href="classAlignmentBinaryFile.html#a881d870113fa00a47af25b1e572f4417">AlignmentBinaryFile::fread_int4</a>(FILE* file) {
<a name="l00557"></a>00557         <span class="keywordtype">int</span> i;
<a name="l00558"></a>00558         fread(&amp;i, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), 1, file);
<a name="l00559"></a>00559         <span class="keywordflow">return</span> ntohl(i);
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="classAlignmentBinaryFile.html#ab593aef726075ac71e6d2998a50f7dd1">00562</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#ab593aef726075ac71e6d2998a50f7dd1">AlignmentBinaryFile::fwrite_int2</a>(<span class="keyword">const</span> <span class="keywordtype">short</span> i, FILE* file) {
<a name="l00563"></a>00563         <span class="keyword">const</span> <span class="keywordtype">short</span> j = htons(i);
<a name="l00564"></a>00564     fwrite(&amp;j, <span class="keyword">sizeof</span>(<span class="keywordtype">short</span>), 1, file);
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a><a class="code" href="classAlignmentBinaryFile.html#a175d1db857761d8d7ed15adb63cc40f7">00567</a> <span class="keywordtype">short</span> <a class="code" href="classAlignmentBinaryFile.html#a175d1db857761d8d7ed15adb63cc40f7">AlignmentBinaryFile::fread_int2</a>(FILE* file) {
<a name="l00568"></a>00568         <span class="keywordtype">short</span> i;
<a name="l00569"></a>00569         fread(&amp;i, <span class="keyword">sizeof</span>(<span class="keywordtype">short</span>), 1, file);
<a name="l00570"></a>00570         <span class="keywordflow">return</span> ntohs(i);
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a><a class="code" href="classAlignmentBinaryFile.html#a9643e27e9086c0f1275e027a24b3704b">00573</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a9643e27e9086c0f1275e027a24b3704b">AlignmentBinaryFile::fwrite_int1</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i, FILE* file) {
<a name="l00574"></a>00574     fwrite(&amp;i, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, file);
<a name="l00575"></a>00575 }
<a name="l00576"></a>00576 
<a name="l00577"></a><a class="code" href="classAlignmentBinaryFile.html#aade9efead2243dd6ab07d0f9f0a0d7f2">00577</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="classAlignmentBinaryFile.html#aade9efead2243dd6ab07d0f9f0a0d7f2">AlignmentBinaryFile::fread_int1</a>(FILE* file) {
<a name="l00578"></a>00578         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i;
<a name="l00579"></a>00579         fread(&amp;i, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>), 1, file);
<a name="l00580"></a>00580         <span class="keywordflow">return</span> i;
<a name="l00581"></a>00581 }
<a name="l00582"></a>00582 
<a name="l00583"></a><a class="code" href="classAlignmentBinaryFile.html#a42b0f57faadb148fdd982598bf56d3e0">00583</a> <span class="keywordtype">void</span> <a class="code" href="classAlignmentBinaryFile.html#a42b0f57faadb148fdd982598bf56d3e0">AlignmentBinaryFile::fread_dummy</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> len, FILE* file) {
<a name="l00584"></a>00584         fseek(file, len, SEEK_CUR);
<a name="l00585"></a>00585 }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Fri May 8 2015 11:39:19 for MASA-Core by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
